<%- include layouts/admin_header.ejs %>
<h1 class="page-header">Eventos<a class="btn btn-primary pull-right" data-toggle="modal" href="#create_evnt">+ Nuevo</a></h1>
<div class="table">
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Descripción</th>
            <th>Tipo</th>
            <th>Fecha</th>
            <th>Duración</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <% if(data.length){
            for(var i = 0;i<data.length;i++){%>
        <tr>
            <td><%= data[i].nom%></td>
            <td><%= data[i].tipo%></td>
            <td><%= new Date(data[i].fecha).toLocaleString()%></td>
            <td><%= data[i].duration%></td>
            <td class="btn-group"><a class="btn btn-warning">Editar</a><a class="btn btn-danger" href="/evnt_delete/<%= data[i].idevento%>">Eliminar</a></td>
        </tr>
        <%  }
        } else {%>
        <tr>
            <td>No hay Eventos creados</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <%}%>
        </tbody>
    </table>
</div>
<div class="modal fade" id="create_evnt" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form action="/evnt_save" method="post">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Crear Evento</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" name="nom" class="form-control">
                    <label>Tipo</label>
                    <input type="text" name="tipo" class="form-control">
                    <label>Fecha</label>
                    <input type="datetime-local" name="fecha" class="form-control">
                    <label>Duración (Minutos)</label>
                    <input type="number" name="duration" class="form-control">
                    <label>Observaciones</label>
                    <input type="textarea" name="obs" class="form-control">
                    <input type="hidden" name="estado" value="new">
                </div>
            </div>
            <div class="modal-footer">
                <div class="btn-group">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                    <button class="btn btn-danger" type="submit">Crear</button>
                </div>
            </div>
            </form>
        </div>
    </div>
</div>
<script>
        function check() {
            if(document.getElementsByName("hasta")[0].value == "no"){
                document.getElementsByName("end")[0].disabled = false;
                document.getElementsByName("hasta")[0].value = "si";
            } else {
                document.getElementsByName("end")[0].disabled = true;
                document.getElementsByName("hasta")[0].value = "no";
            }
        }
    </script>
    <script>
        function getjumps() {

            if (window.XMLHttpRequest) {
                // code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp = new XMLHttpRequest();
            } else {
                // code for IE6, IE5
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    if (this.responseText == "1") {
                        document.getElementById("success").innerHTML = "<div class='alert alert-success'><strong>Exito!</strong> Se genero el csv en el escritorio.</div>";
                        $("#success").fadeTo(2000, 500).slideUp(500, function(){
                            $("#success").slideUp(500);
                        });
                    }
                }
            };
            xmlhttp.open("GET", "/g_csv_j", true);
            xmlhttp.send();
        }
    </script>
<%- include layouts/footer.ejs %>